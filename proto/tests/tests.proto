syntax = "proto3";

package tests;

import "protosearch/protosearch.proto";

message TestCase {
  string basic = 1 [(protosearch.mapping).field = {
    type: "text"
    analyzer: "english"
    coerce: true
    copy_to: "copy_field"
    doc_values: true
    dynamic: DYNAMIC_STRICT
    eager_global_ordinals: true
    enabled: true
    fielddata: {bool_value: true}
    fields: {
      key: "raw"
      value: {type: "keyword"}
    }
    format: "yyyy-MM-dd"
    ignore_above: 256
    ignore_malformed: false
    index_options: INDEX_OPTIONS_POSITIONS
    index: true
    meta: {
      key: "unit"
      value: "ms"
    }
    normalizer: "lowercase"
    norms: true
    null_value: {string_value: "NULL"}
    position_increment_gap: 100
    search_analyzer: "english"
    similarity: "BM25"
    subobjects: "false"
    store: true
    term_vector: "with_positions"
  }];

  string output_name = 2 [(protosearch.mapping).name = "foo"];

  string output_target = 3 [(protosearch.mapping).target = {
    label: "foo"
    json: '{"type": "keyword"}'
  }];
}

message InferTypeTestCase {
  message Message {}

  enum Enum {
    ENUM_UNSPECIFIED = 0;
  }

  string keyword_string = 1 [(protosearch.mapping) = {}];
  Enum keyword_enum = 2 [(protosearch.mapping) = {}];
  bool boolean = 3 [(protosearch.mapping) = {}];
  int32 integer_int32 = 4 [(protosearch.mapping) = {}];
  sint32 integer_sint32 = 5 [(protosearch.mapping) = {}];
  sfixed32 integer_sfixed32 = 6 [(protosearch.mapping) = {}];
  uint32 long_uint32 = 7 [(protosearch.mapping) = {}];
  fixed32 long_fixed32 = 8 [(protosearch.mapping) = {}];
  int64 long_int64 = 9 [(protosearch.mapping) = {}];
  sint64 long_sint64 = 10 [(protosearch.mapping) = {}];
  sfixed64 long_sfixed64 = 11 [(protosearch.mapping) = {}];
  uint64 unsigned_long_uint64 = 12 [(protosearch.mapping) = {}];
  fixed64 unsigned_long_fixed64 = 13 [(protosearch.mapping) = {}];
  float float = 14 [(protosearch.mapping) = {}];
  double double = 15 [(protosearch.mapping) = {}];
  bytes binary = 16 [(protosearch.mapping) = {}];
  Message object = 17 [(protosearch.mapping) = {}];
}

message DynamicTestCase {
  string unspecified = 1 [(protosearch.mapping).field.dynamic = DYNAMIC_UNSPECIFIED];
  string true = 2 [(protosearch.mapping).field.dynamic = DYNAMIC_TRUE];
  string false = 3 [(protosearch.mapping).field.dynamic = DYNAMIC_FALSE];
  string strict = 4 [(protosearch.mapping).field.dynamic = DYNAMIC_STRICT];
  string runtime = 5 [(protosearch.mapping).field.dynamic = DYNAMIC_RUNTIME];
}

message IndexOptionsTestCase {
  string unspecified = 1 [(protosearch.mapping).field.index_options = INDEX_OPTIONS_UNSPECIFIED];
  string docs = 2 [(protosearch.mapping).field.index_options = INDEX_OPTIONS_DOCS];
  string freqs = 3 [(protosearch.mapping).field.index_options = INDEX_OPTIONS_FREQS];
  string positions = 4 [(protosearch.mapping).field.index_options = INDEX_OPTIONS_POSITIONS];
  string offsets = 5 [(protosearch.mapping).field.index_options = INDEX_OPTIONS_OFFSETS];
}

message FieldDataTestcase {
  string struct_value = 1 [(protosearch.mapping).field = {
    type: "text"
    fielddata: {
      struct_value: {
        fields: {
          key: "setting"
          value: {string_value: "value"}
        }
      }
    }
  }];

  string list_value = 2 [(protosearch.mapping).field = {
    type: "text"
    fielddata: {
      list_value: {
        values: [
          {string_value: "a"},
          {bool_value: true}]
      }
    }
  }];

  string null_value = 3 [(protosearch.mapping).field = {
    type: "text"
    fielddata: {null_value: NULL_VALUE}
  }];
}

message InvalidTargetJsonTestCase {
  string invalid_json = 1 [(protosearch.mapping) = {
    target: {
      label: "invalid-json-string"
      json: "foo"
    }
    target: {
      label: "invalid-json-array"
      json: "[1, 2, 3]"
    }
  }];
}

message InvalidFieldNameTestCase {
  string lowercase = 1 [(protosearch.mapping).name = "valid"];
  string with_underscore = 2 [(protosearch.mapping).name = "valid_name"];
  string with_digit = 3 [(protosearch.mapping).name = "field1"];
  string at_prefix = 4 [(protosearch.mapping).name = "@timestamp"];
  string dotted = 5 [(protosearch.mapping).name = "object.field"];

  string empty = 100 [(protosearch.mapping).name = ""];
  string uppercase = 101 [(protosearch.mapping).name = "Title"];
  string leading_digit = 102 [(protosearch.mapping).name = "1field"];
  string hyphen = 103 [(protosearch.mapping).name = "field-name"];
}

message ValueErrorTestCase {
  string ignore_above_valid = 1 [(protosearch.mapping).field = {
    type: "keyword"
    ignore_above: 256
  }];
  string ignore_above_zero = 2 [(protosearch.mapping).field = {
    type: "keyword"
    ignore_above: 0
  }];
  string ignore_above_negative = 3 [(protosearch.mapping).field = {
    type: "keyword"
    ignore_above: -1
  }];
  string position_increment_gap_zero = 4 [(protosearch.mapping).field = {
    type: "text"
    position_increment_gap: 0
  }];
  string position_increment_gap_valid = 5 [(protosearch.mapping).field = {
    type: "text"
    position_increment_gap: 100
  }];
  string position_increment_gap_negative = 6 [(protosearch.mapping).field = {
    type: "text"
    position_increment_gap: -1
  }];
}

message EnumTestCase {
  enum Enum {
    ENUM_UNSPECIFIED = 0;
    ENUM_ACTIVE = 1;
  }

  Enum status_inferred = 1 [(protosearch.mapping).field = {}];
  Enum status_keyword = 2 [(protosearch.mapping).field.type = "keyword"];
  Enum status_integer = 3 [(protosearch.mapping).field.type = "integer"];
}

message MessageTestCase {
  message Message {
    string uid = 1 [(protosearch.mapping).field = {}];
  }

  Message message_object_singular = 1 [(protosearch.mapping).field = {type: "object"}];
  Message message_nested_singular = 2 [(protosearch.mapping).field = {type: "nested"}];
  repeated Message message_object_repeated = 3 [(protosearch.mapping).field = {type: "object"}];
  repeated Message message_nested_repeated = 4 [(protosearch.mapping).field = {type: "nested"}];
  Message message_object_with_parameters = 5 [(protosearch.mapping).field = {
    type: "object"
    dynamic: DYNAMIC_STRICT
  }];
  Message message_nested_with_parameters = 6 [(protosearch.mapping).field = {
    type: "nested"
    dynamic: DYNAMIC_STRICT
  }];
}
