syntax = "proto3";

package tests;

import "protosearch/protosearch.proto";

message TestCase {
  string basic = 1 [(protosearch.field) = {
    type: "text"
    analyzer: "english"
    coerce: true
    copy_to: "copy_field"
    doc_values: true
    dynamic: "strict"
    eager_global_ordinals: true
    enabled: true
    fielddata: {bool_value: true}
    fields: {
      key: "raw"
      value: {type: "keyword"}
    }
    format: "yyyy-MM-dd"
    ignore_above: 256
    ignore_malformed: false
    index_options: "positions"
    index: true
    meta: {
      key: "unit"
      value: "ms"
    }
    normalizer: "lowercase"
    norms: true
    null_value: {string_value: "NULL"}
    position_increment_gap: 100
    search_analyzer: "english"
    similarity: "BM25"
    subobjects: false
    store: true
    term_vector: "with_positions"
  }];

  string output_name = 2 [(protosearch.field) = {
    output: {name: "foo"}
  }];

  string output_target = 3 [(protosearch.field) = {
    output: {
      target: {
        label: "foo"
        json: '{"type": "keyword"}'
      }
    }
  }];
}

message InferTypeTestCase {
  message Message {}

  enum Enum {
    ENUM_UNSPECIFIED = 0;
  }

  string keyword_string = 1 [(protosearch.field) = {}];
  Enum keyword_enum = 2 [(protosearch.field) = {}];
  bool boolean = 3 [(protosearch.field) = {}];
  int32 integer_int32 = 4 [(protosearch.field) = {}];
  sint32 integer_sint32 = 5 [(protosearch.field) = {}];
  sfixed32 integer_sfixed32 = 6 [(protosearch.field) = {}];
  uint32 long_uint32 = 7 [(protosearch.field) = {}];
  fixed32 long_fixed32 = 8 [(protosearch.field) = {}];
  int64 long_int64 = 9 [(protosearch.field) = {}];
  sint64 long_sint64 = 10 [(protosearch.field) = {}];
  sfixed64 long_sfixed64 = 11 [(protosearch.field) = {}];
  uint64 unsigned_long_uint64 = 12 [(protosearch.field) = {}];
  fixed64 unsigned_long_fixed64 = 13 [(protosearch.field) = {}];
  float float = 14 [(protosearch.field) = {}];
  double double = 15 [(protosearch.field) = {}];
  bytes binary = 16 [(protosearch.field) = {}];
  Message object = 17 [(protosearch.field) = {}];
}

message FieldDataTestcase {
  string struct_value = 1 [(protosearch.field) = {
    type: "text"
    fielddata: {
      struct_value: {
        fields: {
          key: "setting"
          value: {string_value: "value"}
        }
      }
    }
  }];

  string list_value = 2 [(protosearch.field) = {
    type: "text"
    fielddata: {
      list_value: {
        values: [
          {string_value: "a"},
          {bool_value: true}]
      }
    }
  }];

  string null_value = 3 [(protosearch.field) = {
    type: "text"
    fielddata: {null_value: NULL_VALUE}
  }];
}

message ErrorsTestCase {
  string invalid_json = 1 [(protosearch.field) = {
    output: {
      target: {
        label: "invalid-json-string"
        json: "foo"
      }
      target: {
        label: "invalid-json-array"
        json: "[1, 2, 3]"
      }
    }
  }];
}

message EnumTestCase {
  enum Enum {
    ENUM_UNSPECIFIED = 0;
    ENUM_ACTIVE = 1;
  }

  Enum status_inferred = 1 [(protosearch.field) = {}];
  Enum status_keyword = 2 [(protosearch.field).type = "keyword"];
  Enum status_integer = 3 [(protosearch.field).type = "integer"];
}

message MessageTestCase {
  message Message {
    string uid = 1 [(protosearch.field) = {}];
  }

  Message message_object_singular = 1 [(protosearch.field) = {type: "object"}];
  Message message_nested_singular = 2 [(protosearch.field) = {type: "nested"}];
  repeated Message message_object_repeated = 3 [(protosearch.field) = {type: "object"}];
  repeated Message message_nested_repeated = 4 [(protosearch.field) = {type: "nested"}];
}
